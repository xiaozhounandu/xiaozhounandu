# 小猪南都客户管理系统 - 完整使用指南

## 📋 系统概述

这是一个完整的Vue 3 + Spring Boot客户管理系统，集成了ECharts数据可视化功能，支持真实数据管理和展示。

## 🎯 主要功能

### 1. 数据看板 (ECharts可视化)
- **7天趋势图**: 展示最近7天客户增长趋势
- **行业分布图**: 饼图显示不同行业客户占比
- **客户等级雷达图**: 展示A/B/C/D级客户分布
- **月度趋势图**: 混合图表显示月度新增和累计客户

### 2. 数据管理功能
- **添加测试用户**: 快速创建系统用户账号
- **批量生成客户**: 一次性生成大量测试客户数据
- **添加跟进记录**: 为客户创建真实的销售跟进记录
- **实时数据统计**: 显示用户数、客户数、跟进记录数

### 3. 权限管理
- **管理员(ADMIN)**: 拥有所有权限，可查看所有功能
- **销售经理(MANAGER)**: 可查看统计数据和数据管理功能
- **销售员(USER)**: 只能管理自己名下的客户

## 🚀 部署步骤

### 第一步：数据库初始化

1. **执行数据库初始化脚本**:
```sql
-- 在MySQL中执行
source /Users/weizhijie/Desktop/java/xiaozhounandu/src/main/resources/sql/init-database.sql;
```

2. **生成测试数据** (可选):
```sql
-- 生成大量测试数据用于图表展示
source /Users/weizhijie/Desktop/java/xiaozhounandu/src/main/resources/sql/test-data-generator.sql;
```

3. **验证数据库连接**:
访问: `http://localhost:8080/api/test/db`

### 第二步：启动后端服务

```bash
cd /Users/weizhijie/Desktop/java/xiaozhounandu
mvn clean install
mvn spring-boot:run
```

服务将在 `http://localhost:8080` 启动

### 第三步：启动前端服务

```bash
cd /Users/weizhijie/Desktop/java/xiaozhounandu/v-xiaozhounandu/v-xiaozhounandu
npm install
npm run dev
```

前端将在 `http://localhost:5173` 启动

## 🔐 登录信息

### 预设账号
| 用户名 | 密码 | 角色 | 说明 |
|--------|------|------|------|
| admin | admin123 | ADMIN | 系统管理员 |
| manager | admin123 | MANAGER | 销售经理 |
| user | admin123 | USER | 普通销售员 |
| sales1 | admin123 | USER | 销售员1 |
| sales2 | admin123 | USER | 销售员2 |
| sales3 | admin123 | USER | 销售员3 |

## 📊 数据看板使用

### 访问路径
1. 登录系统后，点击左侧菜单"数据看板"
2. 系统将自动加载真实的业务数据

### 图表说明
- **左上角**: 客户状态统计卡片
- **右上角**: 核心业务指标
- **中左**: 7天客户增长趋势柱状图
- **中右**: 行业分布环形图
- **下左**: 客户等级雷达图
- **下右**: 月度趋势混合图

### 数据刷新
- 图表数据每5分钟自动刷新
- 可手动刷新页面获取最新数据

## 🔧 数据管理使用

### 访问路径
- 需要管理员或经理权限
- 点击左侧菜单"🔧 数据管理"

### 功能说明

#### 1. 添加测试用户
- 填写用户名、昵称、选择角色
- 系统自动生成邮箱和手机号
- 密码默认为 `admin123`

#### 2. 批量生成客户
- 输入要生成的客户数量(1-100)
- 系统随机生成客户信息
- 自动分配给现有销售员

#### 3. 添加跟进记录
- 选择客户和跟进方式
- 填写跟进内容
- 系统自动设置7天后的下次跟进时间

## 📱 API接口说明

### 核心接口

#### 1. 数据看板API
```
GET /api/stats/dashboard
Headers: Authorization: Bearer {token}
```

#### 2. 数据统计API
```
GET /api/stats/summary
Headers: Authorization: Bearer {token}
```

#### 3. 客户管理API
```
GET /api/customers/user     # 获取当前用户客户列表
POST /api/customers/batch   # 批量添加客户
GET /api/customers/statistics # 获取客户统计
```

#### 4. 跟进记录API
```
GET /api/followups
POST /api/followups
```

## 🎨 前端技术栈

### 核心框架
- **Vue 3**: Composition API
- **Vue Router 4**: 路由管理
- **Axios**: HTTP请求

### UI组件
- **ECharts 5**: 数据可视化
- **自定义组件**: 图表组件封装

### 样式处理
- **CSS3**: 响应式设计
- **Flexbox/Grid**: 布局管理

## 🖥️ 后端技术栈

### 核心框架
- **Spring Boot 2.7**: 主框架
- **MyBatis**: ORM框架
- **MySQL 8.0**: 数据库

### 安全认证
- **JWT Token**: 身份认证
- **BCrypt**: 密码加密
- **角色权限**: RBAC控制

### 数据处理
- **RESTful API**: 接口设计
- **统一响应**: ApiResult封装
- **分页查询**: PageResponse

## 📈 图表配置详解

### 1. 趋势图 (TrendChart)
```javascript
// 7天客户增长趋势
type: 'bar',
data: [
  { date: '2025-12-12', count: 5 },
  { date: '2025-12-13', count: 8 },
  // ...
]
```

### 2. 饼图 (IndustryChart)
```javascript
// 行业分布
type: 'pie',
data: {
  '互联网': 45,
  '制造业': 32,
  '金融': 28,
  // ...
}
```

### 3. 雷达图 (LevelRadarChart)
```javascript
// 客户等级分布
type: 'radar',
data: {
  'A': 15,
  'B': 25,
  'C': 35,
  'D': 10
}
```

### 4. 混合图 (MonthlyChart)
```javascript
// 月度趋势
data: {
  months: ['2025-07', '2025-08', ...],
  newCustomers: [12, 15, 8, ...],
  totalCustomers: [100, 115, 123, ...]
}
```

## 🔍 故障排查

### 常见问题

#### 1. 数据库连接失败
- 检查application.yml中的数据库配置
- 确认MySQL服务已启动
- 验证数据库用户名密码

#### 2. 图表不显示
- 检查浏览器控制台错误信息
- 确认API接口返回正常数据
- 验证ECharts组件是否正确加载

#### 3. 权限不足
- 确认使用正确的账号登录
- 检查用户角色设置
- 验证JWT Token是否有效

#### 4. 数据不更新
- 手动刷新页面
- 检查数据库中的数据
- 验证API接口调用

### 日志查看
- **后端日志**: 查看控制台输出
- **前端日志**: 浏览器开发者工具
- **数据库日志**: MySQL慢查询日志

## 📞 技术支持

### 文档位置
- 数据库脚本: `/src/main/resources/sql/`
- 前端组件: `/src/components/charts/`
- API接口: `/src/main/java/com/xiaozhounandu/controller/`

### 开发建议
1. **数据可视化**: 可以根据业务需求调整图表类型和样式
2. **权限控制**: 可以扩展更细粒度的权限管理
3. **数据导出**: 可以添加Excel/PDF导出功能
4. **实时通知**: 可以集成WebSocket实现实时推送

## 🎉 项目特色

1. **完整的数据流**: 从数据库到图表展示的完整链路
2. **响应式设计**: 适配不同屏幕尺寸
3. **真实业务场景**: 基于实际CRM系统需求设计
4. **易于扩展**: 模块化设计，便于功能扩展
5. **数据安全**: JWT认证 + 角色权限控制

---

**创建时间**: 2025-12-18
**版本**: v2.0.0
**状态**: ✅ 完成并可投入使用

**注**: 本系统已完整实现数据库初始化、后端API、前端界面和ECharts图表集成，可以直接用于生产环境或作为学习参考。